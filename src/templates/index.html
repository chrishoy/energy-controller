<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Rates</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    <script>
        // Register the annotation plugin
        Chart.register(ChartAnnotation);
    </script>
</head>

<body>
    <div class="current-rate">
        <p>Current Price inc. VAT: <span id="current-price">Loading...</span> p/kWh</p>
        <p>As At: <span id="as-at">Loading...</span></p>
        <p>Valid Until: <span id="valid-until">Loading...</span></p>
        <p>Rates Read: <span id="rates-updated">Loading...</span></p>
    </div>

    <div class="heating-schedule"
        style="background-color: #f8f9fa; padding: 20px; border-radius: 5px; margin-bottom: 20px;">
        <h3>Optimized Heating Schedule</h3>
        <div id="heating-summary">Loading heating schedule...</div>
    </div>
    <div class="chart-container">
        <canvas id="ratesChart"></canvas>
    </div>

    <script src="{{ url_for('static', filename='utils.js') }}"></script>
    <script src="{{ url_for('static', filename='chart.js') }}"></script>
    <script src="{{ url_for('static', filename='api.js') }}"></script>
    <script>
        // Update rates immediately and then every 5 minutes
        updateRates();
        setInterval(updateRates, 300000);
    </script>
</body>

</html>